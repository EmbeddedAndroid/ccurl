/*
 * (c) 2016 Paul Handy, based on code from come-from-beyond
 */

#include "Hash.h"
#include "Curl.h"
#include "PearlDiver.h"
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define __TRUTH_TABLE  	\
	1, 0, -1, \
	1, -1, 0, \
	-1, 1, 0

static const long TRUTH_TABLE[9] = { __TRUTH_TABLE };

void transform(Curl *ctx);

void init_curl(Curl *ctx) {
	ctx->state = malloc(sizeof(trit_t) * STATE_LENGTH);
	memset(ctx->state,0,STATE_LENGTH);
}
long first[] = (long []){-1, 1, 0, 1, -1, 1, 0, 0, -1, -1, 1, -1, 0, 0, 1, 0, 1, 1, 0, 0, -1, -1, -1, 0, -1, 1, -1, 0, 0, -1, 1, 1, 0, 0, -1, 1, 0, 0, 0, -1, -1, 1, 0, -1, -1, 1, 1, -1, 1, 1, 1, 1, 1, -1, 1,0, 0, 1, 1, 0, 0, 0, 0, -1, -1, -1, -1, -1, 1, 1, 1, 1, 0, 0, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 0, 1, 0, 0, 0, -1, -1, -1, 1, 1, -1, 1, -1, 0, -1, 0, -1, 1, -1, -1, -1, -1, 0, 0, 0, -1, 1, 1, -1, 1, 0, -1, -1, -1, 1, -1, 0, 0, -1, -1, 0, -1, 0, 1, 0, 1, 1, -1, -1, -1, 0, 0, -1, -1, 0, -1, 0, -1, -1, 1, 0, 0, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 0, -1, 0, 1, 0, -1, -1, 0, -1, 1, 0, 1, 1, -1, -1, 0, -1, 1, 0, 1, 1, 0, -1, 1, -1, 1, 0, 1, 1, -1, 1, -1, 0, 0, -1, -1, 0, -1, 1, -1, 1, 0, -1, -1, -1, -1, 0, 0, 1, 1, -1, -1, 1, -1, 0, -1, -1, 0, -1, -1, 1, -1, 1, 0, -1, 0, -1, -1, 1, -1, 0, 1, -1, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, -1, 1, 0, 1, -1, 0, -1, 1, 0, 0, 0, -1, 1, 1, -1, 1, 0, 1, -1, 0, 0, 1, -1, 0, 1, -1, 0, -1, 0, 0, 1, 0, 1, 0, 1, -1, -1, -1, -1, 1, 0, 0, 1, 1, 0, -1, -1, 1, 1, -1, 1, -1, 0, -1, -1, -1, -1, -1, 1, -1, 1, 1, 0, -1, 0, -1, 1, 1, -1, -1, -1, 1, 1, -1, 0, -1, 0, 0, -1, 1, -1, -1, -1, 1, -1, -1, 1, 0, -1, 1, 1, -1, -1, 0, 0, 0, -1, 1, 1, 0, 0, 1, 1, -1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, -1, 1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 1, -1, 0, -1, 1, -1, -1, 0, 0, 0, 1, -1, 1, -1, 1, 1, 0, 0, -1, 1, -1, 1, -1, -1, 0, 1, 1, -1, 0, -1, 1, 1, -1, 1, -1, 0, 1, 0, 1, 0, -1, -1, 0, 1, 0, 0, -1, 1, -1, 0, 0, 0, 0, 1, 1, 1, 0, -1, -1, 0, -1, 1, 0, -1, 1, -1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, -1, 1, 1, -1, 0, 0, 0, 0, -1, 0, -1, -1, -1, 1, 1, -1, -1, 1, -1, 0, -1, 0, 0, -1, -1, -1, 0, -1, 0, 0, 1, 0, 1, 1, -1, 0, 0, 0, 0, 0, 1, 1, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, -1, -1, -1, 0, 0, 0, 1, 0, 1, -1, 0, -1, -1, 1, 1, -1, -1, 0, -1, 1, 0, 0, 0, -1, 0, 1, 1, 0, 0, 0, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 0, 1, -1, -1, -1, 0, 0, 0, 0, 1, 1, -1, 0, 1, 1, 0, -1, 1, 0, -1, 1, 1, -1, 1, 0, 1, -1, 1, 0, 0, 0, -1, 1, -1, 0, -1, 0, 0, -1, -1, 1, -1, 0, -1, 0, -1, -1, -1, 1, -1, 1, -1, 0, 1, -1, -1, -1, 1, 0, 1, 0, 1, 0, 0, -1, 0, 1, 0, 1, 1, -1, 0, -1, 0, -1, 0, -1, 1, 0, 1, -1, 1, 0, 1, 0, 1, 1, 1, -1, -1, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, 0, 0, -1, 0, 0, 1, -1, -1, -1, 0, 0, -1, 1, -1, 0, 0, 0, -1, -1, -1, -1, 0, 0, -1, -1, 1, -1, -1, -1, -1, 0, 0, 0, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, 1, 1, 1, 0, 1, 1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, -1, 0, -1, -1, -1, 1, 1, 0, -1, 0, 1, 0, -1, -1};
long last[] = (long []){-1, 1, 0, 1, -1, 1, 0, 0, -1, -1, 1, -1, 0, 0, 1, 0, 1, 1, 0, 0, -1, -1, -1, 0, -1, 1, -1, 0, 0, -1, 1, 1, 0, 0, -1, 1, 0, 0, 0, -1, -1, 1, 0, -1, -1, 1, 1, -1, 1, 1, 1, 1, 1, -1, 1, 0, 0, 1, 1, 0, 0, 0, 0, -1, -1, -1, -1, -1, 1, 1, 1, 1, 0, 0, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 0, 1, 0, 0, 0, -1, -1, -1, 1, 1, -1, 1, -1, 0, -1, 0, -1, 1, -1, -1, -1, -1, 0, 0, 0, -1, 1, 1, -1, 1, 0, -1, -1, -1, 1, -1, 0, 0, -1, -1, 0, -1, 0, 1, 0, 1, 1, -1, -1, -1, 0, 0, -1, -1, 0, -1, 0, -1, -1, 1, 0, 0, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 0, -1, 0, 1, 0, -1, -1, 0, -1, 1, 0, 1, 1, -1, -1, 0, -1, 1, 0, 1, 1, 0, -1, 1, -1, 1, 0, 1, 1, -1, 1, -1, 0, 0, -1, -1, 0, -1, 1, -1, 1, 0, -1, -1, -1, -1, 0, 0, 1, 1, -1, -1, 1, -1, 0, -1, -1, 0, -1, -1, 1, -1, 1, 0, -1, 0, -1, -1, 1, -1, 0, 1, -1, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, -1, 1, 0, 1, -1, 0, -1, 1, 0, 0, 0, -1, 1, 1, -1, 1, 0, 1, -1, 0, 0, 1, -1, 0, 1, -1, 0, -1, 0, 0, 1, 0, 1, 0, 1, -1, -1, -1, -1, 1, 0, 0, 1, 1, 0, -1, -1, 1, 1, -1, 1, -1, 0, -1, -1, -1, -1, -1, 1, -1, 1, 1, 0, -1, 0, -1, 1, 1, -1, -1, -1, 1, 1, -1, 0, -1, 0, 0, -1, 1, -1, -1, -1, 1, -1, -1, 1, 0, -1, 1, 1, -1, -1, 0, 0, 0, -1, 1, 1, 0, 0, 1, 1, -1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, -1, 1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 1, -1, 0, -1, 1, -1, -1, 0, 0, 0, 1, -1, 1, -1, 1, 1, 0, 0, -1, 1, -1, 1, -1, -1, 0, 1, 1, -1, 0, -1, 1, 1, -1, 1, -1, 0, 1, 0, 1, 0, -1, -1, 0, 1, 0, 0, -1, 1, -1, 0, 0, 0, 0, 1, 1, 1, 0, -1, -1, 0, -1, 1, 0, -1, 1, -1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, -1, 1, 1, -1, 0, 0, 0, 0, -1, 0, -1, -1, -1, 1, 1, -1, -1, 1, -1, 0, -1, 0, 0, -1, -1, -1, 0, -1, 0, 0, 1, 0, 1, 1, -1, 0, 0, 0, 0, 0, 1, 1, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, -1, -1, -1, 0, 0, 0, 1, 0, 1, -1, 0, -1, -1, 1, 1, -1, -1, 0, -1, 1, 0, 0, 0, -1, 0, 1, 1, 0, 0, 0, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 0, 1, -1, -1, -1, 0, 0, 0, 0, 1, 1, -1, 0, 1, 1, 0, -1, 1, 0, -1, 1, 1, -1, 1, 0, 1, -1, 1, 0, 0, 0, -1, 1, -1, 0, -1, 0, 0, -1, -1, 1, -1, 0, -1, 0, -1, -1, -1, 1, -1, 1, -1, 0, 1, -1, -1, -1, 1, 0, 1, 0, 1, 0, 0, -1, 0, 1, 0, 1, 1, -1, 0, -1, 0, -1, 0, -1, 1, 0, 1, -1, 1, 0, 1, 0, 1, 1, 1, -1, -1, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, 0, 0, -1, 0, 0, 1, -1, -1, -1, 0, 0, -1, 1, -1, 0, 0, 0, -1, -1, -1, -1, 0, 0, -1, -1, 1, -1, -1, -1, -1, 0, 0, 0, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, 1, 1, 1, 0, 1, 1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, -1, 0, -1, -1, -1, 1, 1, 0, -1, 0, 1, 0, -1, -1};
long firstsq[] = (long []){0, 1, 1, 0, -1, 1, 1, -1, 1, 1, -1, -1, 0, -1, 0, -1, -1, -1, -1, -1, -1, 0, 1, -1, -1, 0, -1, 0, -1, -1, 1, -1, 1, 1, 1, 1, -1, 1, 0, 0, 1, -1, -1, 1, -1, 0, 1, -1, 0, 0, -1, 1, 1, 0, 0, -1, 0, -1, -1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, -1, 0, 0, 0, -1, 0, 1, -1, 1, 0, 0, 0, 0, -1, 1, -1, 0, -1, 1, 0, 0, -1, 0, 0, -1, 0, 1, 0, 1, 0, -1, 1, -1, 0, 0, 0, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, 0, 0, 0, -1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, -1, 0, -1, 0, 1, 0, -1, -1, 0, -1, 1, 1, 0, 1, 0, 1, -1, -1, 0, -1, 0, -1, 1, 1, 0, 1, 1, -1, 1, 1, -1, 0, 0, 0, 0, -1, 0, 1, -1, -1, -1, 0, 0, 0, -1, -1, 0, -1, -1, 0, -1, 1, 0, 1, 0, -1, 1, 1, 0, 0, -1, -1, 1, 0, -1, 0, 1, 1, -1, 1, -1, 0, 1, 1, 1, 1, 0, 1, 0, 1, -1, 1, -1, 0, -1, 1, 0, -1, 0, 0, 0, 0, -1, -1, 1, 0, -1, 1, 1, -1, -1, -1, 0, 1, -1, 0, 1, -1, -1, 1, -1, 0, -1, -1, 1, 1, 1, -1, -1, 0, 0, 1, -1, -1, 1, 1, -1, -1, -1, 0, -1, 1, -1, 1, -1, 1, 0, 0, 0, 0, 0, 0, 1, -1, 0, 1, 1, 0, 0, -1, 0, -1, 0, 1, 0, 0, -1, 0, 1, 0, 1, -1, 1, 1, -1, 0, -1, 0, 1, -1, 0, 1, 0, -1, -1, 0, 1, 1, -1, -1, -1, 0, 0, 0, -1, -1, 1, -1, 1, 1, 0, 1, 0, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, 0, 0, 1, 1, 1, -1, -1, 0, 1, 0, 1, 1, 1, -1, 0, 1, -1, 1, -1, -1, 1, -1, 1, 0, 1, -1, 0, -1, 0, 0, -1, 1, 1, 1, 0, 0, -1, -1, 0, 0, 0, 0, 1, 1, 0, 0, -1, 0, 1, -1, -1, 0, 1, -1, -1, -1, -1, 1, -1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, -1, 0, -1, -1, 1, 1, -1, -1, -1, -1, 0, 0, -1, 1, 0, 0, 1, 1, 1, -1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, -1, -1, 0, -1, -1, 1, -1, 1, 0, 1, -1, 0, 1, 1, 1, 0, -1, 0, 0, 1, 0, 1, 0, 0, -1, -1, 0, 1, 1, 1, 1, -1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, -1, -1, 0, 0, 1, 0, -1, -1, 1, 0, 1, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, -1, 0, 1, -1, 1, 0, 1, 0, -1, -1, 0, -1, -1, 0, 0, 0, 0, -1, 1, 1, 0, 1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 1, 1, -1, 0, 0, 0, 0, -1, 1, 0, 1, -1, 0, 0, 0, -1, 0, 0, -1, 0, 1, 1, 0, 0, 1, 0, 1, 0, -1, 1, -1, 0, 0, 1, -1, 1, -1, -1, 0, -1, 1, 0, 0, 0, 1, 1, -1, 0, 1, 1, 0, 1, 0, 1, -1, 1, 0, -1, 0, -1, 0, 0, -1, 1, 1, -1, -1, 1, 1, 0, -1, -1, 0, -1, 1, -1, -1, 0, -1, 1, 0, 1, -1, -1, -1, -1, -1, 0, 1, -1, 1, 1, -1, 1, 0, -1, 1, 1, 1, -1, 0, 0, 1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, 0, 0, -1, 0, -1, -1, 0, -1, -1, 1, -1, -1, -1, -1, 1, 0, -1, -1, 0, 0, 0, -1, 1, 0, 0, 0, -1, -1, 0, -1, 1, -1, -1, 1, 1, 1, -1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, -1, 0, 0, -1, 0, 0, 0, 1, 1, -1, 0, 1, -1, 1};
long sqtrits[] = (long []){1, 1, 1, 1, 1, 0, 0, 0, 1, -1, 0, -1, 0, 0, 0, 0, 1, 0, 1, 0, 1, -1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, -1, 1, 0, -1, -1, 1, 1, 0, 1, 1, 1, 1, 0, -1, 0, 1, 0, -1, 0, 0, 1, 1, 0, 0, 0, 0, -1, 0, 0, 1, 0, -1, 1, 0, 1, 1, 1, -1, 1, 1, 1, 1, 1, 0, 1, 1, -1, 1, 1, 1, -1, 0, 1, 0, 1, -1, -1, 0, 1, 1, 0, 1, 0, -1, 1, 1, 1, 0, 1, 0, 1, 1, -1, -1, -1, -1, -1, 1, -1, 0, 1, 1, 0, 1, 0, -1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 1, -1, 0, 1, 1, 1, -1, 0, -1, 0, -1, 1, 1, 1, 0, 1, 1, -1, 0, -1, -1, -1, 0, 0, 1, -1, -1, 0, 0, -1, 1, -1, 1, 0, 0, -1, 1, 1, 1, -1, -1, 1, -1, 0, 0, -1, 1, -1, -1, 0, 0, 1, 0, 0, 1, 0, -1, -1, -1, 1, 1, -1, 0, -1, 1, -1, 0, 0, 0, 1, -1, 1, 0, 1, 1, 1, -1, -1, 0, 1, -1, 1, 0, 0, 0, 1, -1, 0, -1, 1, 1, 0, 0, -1, -1, 1, -1, 0, -1, 0, 1, 0, 1, 0, -1, 0, 1, -1, 0, 1, 1, 0, -1, -1, -1, -1, 1, 0, -1, 1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, -1, 1, 1, -1, 0, 0, -1, 1, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, 0, -1, 1, 0, 1, 1, 1, -1, 0, 1, 0, 1, 1, -1, -1, -1, 0, 1, 1, -1, 1, 0, 0, 0, 1, 1, 0, -1, 0, 1, 1, 1, 0, 0, 0, 1, -1, 1, 0, 0, 0, 0, -1, 1, 0, 0, 1, 0, 0, 0, -1, -1, 1, 0, 1, 0, 0, 1, -1, -1, 0, 0, 0, 1, 0, -1, 0, -1, 1, -1, -1, 0, 1, 1, 0, -1, 1, -1, -1, 1, 1, 0, -1, 0, 1, -1, 1, -1, 1, 1, 1, 0, 0, -1, 0, 0, 1, -1, 1, 0, -1, 0, 1, 1, 1, 0, 1, 0, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 0, 1, -1, 0, -1, 1, 1, 1, 1, 0, 1, -1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 0, -1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, -1, -1, -1, 0, 0, -1, 1, -1, -1, 1, 1, 0, -1, 1, 0, 0, 1, -1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, -1, 0, -1, 1, 1, 1, 1, 1, 1, 1, 0, -1, 0, 0, 0, -1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, -1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 0, -1, 0, 1, 1, 0, -1, 1, 1, 0, 1, 1, -1, 0, 0, 0, -1, 1, -1, 1, -1, 1, -1, 0, 1, -1, -1, -1, 0, 0, 1, -1, -1, -1, 0, 0, 1, 0, 1, 0, -1, 0, 0, 0, -1, 0, 0, 1, 1, 0, -1, 0, 1, 1, -1, 0, 0, 1, 0, 1, 1, -1, 1, -1, 1, 0, -1, 0, 0, -1, 1, 0, 1, -1, -1, 0, 1, 0, 1, 0, 0, -1, 1, -1, -1, 1, 0, -1, -1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, -1, 1, 1, -1, 0, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, 0, 1, 0, 1, -1, 1, 1, -1, -1, -1, 0, -1, 1, 1, 0, 0, 0, 0, 0, 1, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, -1, 1, -1, 0, -1, 0, 0, 0, 1, 1, 0, -1, 1, 1, -1, 0, 1, 0, 0, -1, 0, 0, 0, 1, 1, 0, 1, -1, 1, -1, 1, -1, 0, 1, 1, -1, -1, -1, -1, 1, 1, 0, 0, 1, 0, -1, 0, 0, 1, 0, 0, 0, 0, 1, 1, -1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, -1, 0, 1}; 
long sqtr1[] = (long []){1, 1, 1, 1, 1, 0, 0, 0, 1, -1, 0, -1, 0, 0, 0, 0, 1, 0, 1, 0, 1, -1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, -1, 1, 0, -1, -1, 1, 1, 0, 1, 1, 1, 1, 0, -1, 0, 1, 0, -1, 0, 0, 1, 1, 0, 0, 0, 0, -1, 0, 0, 1, 0, -1, 1, 0, 1, 1, 1, -1, 1, 1, 1, 1, 1, 0, 1, 1, -1, 1, 1, 1, -1, 0, 1, 0, 1, -1, -1, 0, 1, 1, 0, 1, 0, -1, 1, 1, 1, 0, 1, 0, 1, 1, -1, -1, -1, -1, -1, 1, -1, 0, 1, 1, 0, 1, 0, -1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 1, -1, 0, 1, 1, 1, -1, 0, -1, 0, -1, 1, 1, 1, 0, 1, 1, -1, 0, -1, -1, -1, 0, 0, 1, -1, -1, 0, 0, -1, 1, -1, 1, 0, 0, -1, 1, 1, 1, -1, -1, 1, -1, 0, 0, -1, 1, -1, -1, 0, 0, 1, 0, 0, 1, 0, -1, -1, -1, 1, 1, -1, 0, -1, 1, -1, 0, 0, 0, 1, -1, 1, 0, 1, 1, 1, -1, -1, 0, 1, -1, 1, 0, 0, 0, 1, -1, 0, -1, 1, 1, 0, 0, -1, -1, 1, -1, 0, -1, 0, 1, 0, 1, 0, -1, 0, 1, -1, 0, 1, 1, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, -1, -1, 0, 0, 0, -1, 0, -1, 0, -1, 0, -1, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, -1, -1, -1, -1, 0, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, 0, 0, -1, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, -1, -1, -1, 0, -1, -1, -1, -1, 0, 0, 0, -1, -1, 0, 0, -1, -1, -1, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, -1, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, -1, 0, 0, -1, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, -1, -1, -1, -1, -1, 0, -1, -1, -1, 0, -1, -1, -1, 0, -1, 0, -1, 0, -1, 0, -1, 0, -1, -1, 0, 0, -1, -1, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, -1, 0, 0, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, 0, 0, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, -1, -1, 0, 0, -1, 0, -1, -1, 0, -1, -1, 0, -1, 0, 0, -1, -1, 0, -1, -1, 0, -1, -1, 0, -1, -1, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, 0, 0, 0, -1, 0, -1, 0, -1, 0, -1, -1, 0, -1, -1, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, -1, 0, 0, -1, 0, -1, 0, -1, -1, -1, -1, -1, -1, -1, 0, -1, 0, 0, -1, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, -1, 0, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, -1, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, -1, -1, 0};
long sqtr2[] = (long []){1, 1, 1, 1, 1, 0, 0, 0, 1, -1, 0, -1, 0, 0, 0, 0, 1, 0, 1, 0, 1, -1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, -1, 1, 0, -1, -1, 1, 1, 0, 1, 1, 1, 1, 0, -1, 0, 1, 0, -1, 0, 0, 1, 1, 0, 0, 0, 0, -1, 0, 0, 1, 0, -1, 1, 0, 1, 1, 1, -1, 1, 1, 1, 1, 1, 0, 1, 1, -1, 1, 1, 1, -1, 0, 1, 0, 1, -1, -1, 0, 1, 1, 0, 1, 0, -1, 1, 1, 1, 0, 1, 0, 1, 1, -1, -1, -1, -1, -1, 1, -1, 0, 1, 1, 0, 1, 0, -1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 1, -1, 0, 1, 1, 1, -1, 0, -1, 0, -1, 1, 1, 1, 0, 1, 1, -1, 0, -1, -1, -1, 0, 0, 1, -1, -1, 0, 0, -1, 1, -1, 1, 0, 0, -1, 1, 1, 1, -1, -1, 1, -1, 0, 0, -1, 1, -1, -1, 0, 0, 1, 0, 0, 1, 0, -1, -1, -1, 1, 1, -1, 0, -1, 1, -1, 0, 0, 0, 1, -1, 1, 0, 1, 1, 1, -1, -1, 0, 1, -1, 1, 0, 0, 0, 1, -1, 0, -1, 1, 1, 0, 0, -1, -1, 1, -1, 0, -1, 0, 1, 0, 1, 0, -1, 0, 1, -1, 0, 1, 1, 0, -1, -1, -1, -1, 1, 0, -1, 1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, -1, 1, 1, -1, 0, 0, -1, 1, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, 0, -1, 1, 0, 1, 1, 1, -1, 0, 1, 0, 1, 1, -1, -1, -1, 0, 1, 1, -1, 1, 0, 0, 0, 1, 1, 0, -1, 0, 1, 1, 1, 0, 0, 0, 1, -1, 1, 0, 0, 0, 0, -1, 1, 0, 0, 1, 0, 0, 0, -1, -1, 1, 0, 1, 0, 0, 1, -1, -1, 0, 0, 0, 1, 0, -1, 0, -1, 1, -1, -1, 0, 1, 1, 0, -1, 1, -1, -1, 1, 1, 0, -1, 0, 1, -1, 1, -1, 1, 1, 1, 0, 0, -1, 0, 0, 1, -1, 1, 0, -1, 0, 1, 1, 1, 0, 1, 0, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 0, 1, -1, 0, -1, 1, 1, 1, 1, 0, 1, -1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 0, -1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, -1, -1, -1, 0, 0, -1, 1, -1, -1, 1, 1, 0, -1, 1, 0, 0, 1, -1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, -1, 0, -1, 1, 1, 1, 1, 1, 1, 1, 0, -1, 0, 0, 0, -1, 1, 0, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, 0, 0, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, -1, -1, 0, 0, -1, 0, -1, -1, 0, -1, -1, 0, -1, 0, 0, -1, -1, 0, -1, -1, 0, -1, -1, 0, -1, -1, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, 0, 0, 0, -1, 0, -1, 0, -1, 0, -1, -1, 0, -1, -1, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, -1, 0, 0, -1, 0, -1, 0, -1, -1, -1, -1, -1, -1, -1, 0, -1, 0, 0, -1, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, -1, 0, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, -1, -1, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, -1, -1, 0};
int i = 0;
void absorb(Curl *ctx, long *const trits, int offset, int length) {
	do {
		memcpy(ctx->state, trits+offset, (length < HASH_LENGTH? length: HASH_LENGTH) * sizeof(long));
		transform(ctx);
		offset += HASH_LENGTH;
	} while ((length -= HASH_LENGTH) > 0);
}

void squeeze(Curl *ctx, long *trits, int offset, int length) {
	do {
		memcpy(trits+offset,  ctx->state, (length < HASH_LENGTH? length: HASH_LENGTH) * sizeof(long));
		transform(ctx);
		offset += HASH_LENGTH;
	} while ((length -= HASH_LENGTH) > 0);
	if(i++ == 0) fprintf(stderr, "My SQ works? 0 is good %d \n", memcmp(sqtrits,trits,STATE_LENGTH));
}

void transform(Curl *ctx) {
	long scratchpad[STATE_LENGTH];
	int scratchpadIndex = 0;
	int scratchpadIndexSave;
	for (int round = 0; round < NUMBER_OF_ROUNDS; round++) {
		memcpy(scratchpad, ctx->state,STATE_LENGTH * sizeof(long));
		for (int stateIndex = 0; stateIndex < STATE_LENGTH; stateIndex++) {
			scratchpadIndexSave = scratchpadIndex;
			scratchpadIndex += (scratchpadIndex < 365 ? 364 : -365);
			ctx->state[stateIndex] = TRUTH_TABLE[scratchpad[scratchpadIndexSave ] + scratchpad[scratchpadIndex ] * 3 + 4];
		}
	}
}

void reset(Curl *ctx) {
	memset(ctx->state,0,STATE_LENGTH * sizeof(long));
}
